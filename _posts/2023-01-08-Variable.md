---
title: "Variable Selection: Logistic Regression Modeling in R"
date: "2023-05-04"
tags: [R, R Studio, R Markdown, Regression Analysis]
excerpt: "Determine an optimal logistic regression model to predict the causation of adult-onset diabetes"
mathjax: true
---

## Background

The objective of this project was to determine an optimal logistic regression model for predicting whether a patient had adult-onset diabetes based on certain diagnostic measurements. This dataset was downloaded from Kaggle and originally comes from the National Institute of Diabetes and Digestive and Kidney Diseases. All patients in the data set are females of Pima Indian heritage and at least 21 years old. I was assisted on this project by Dr. Qingning Zhou from the Mathematics and Statistics Department at the UNC Charlotte. 

## Exploratory Data Analysis

We must first import the dataset from Kaggle. Three of the field names from the original data set were rather lengthy, so we can alias them with more appropriate names. 

```r
library(readr)
dia <- read_csv("~/Diabetes Research/diabetes.csv")
names(dia)[c(3,4,7)] = c("Bpsi", "Skin", "DPF")
```

`Pregnancies` expresses the number of pregnancies per individual. `Glucose` expresses their glucose level. `Bpsi` expresses their blood pressure measurement. `Skin` expresses the thickness of their skin. `Insulin` expresses the insulin level detected in their blood. `BMI` expresses body mass index. `DPF` expresses a numeric value calculated by a diabetes pedigree function that determines the risk of type 2 diabetes based on family history (higher values indicate a higher risk). `Age` expresses the individual's age. `Outcome` is a binary variable expressing the result of having Type 2 diabetes (denoted by 1) or not (denoted by 0).

Next, we can take a look at the distributions of each field in the dataset.

```r
summary(dia)
dia.df = as.data.frame(dia) # changing the list into a data frame 
par(mfrow=c(3,3))
for(i in 1:9){
  hist(dia.df[,i], xlab=colnames(dia.df[i]), main=paste("Histogram of", colnames(dia.df[i])), col="lightgreen", breaks=30)
  }
```

 ##  Pregnancies        Glucose           Bpsi             Skin          Insulin           BMI             DPF              Age           Outcome     
 ## Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00   Min.   :  0.0   Min.   : 0.00   Min.   :0.0780   Min.   :21.00   Min.   :0.000  
 ## 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00   1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437   1st Qu.:24.00   1st Qu.:0.000  
 ## Median : 3.000   Median :117.0   Median : 72.00   Median :23.00   Median : 30.5   Median :32.00   Median :0.3725   Median :29.00   Median :0.000  
 ## Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54   Mean   : 79.8   Mean   :31.99   Mean   :0.4719   Mean   :33.24   Mean   :0.349  
 ## 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00   3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262   3rd Qu.:41.00   3rd Qu.:1.000  
 ## Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00   Max.   :846.0   Max.   :67.10   Max.   :2.4200   Max.   :81.00   Max.   :1.000  


![]({{ site.url }}{{ site.baseurl }}/images/Variable/explore_hist.png)<!-- -->


